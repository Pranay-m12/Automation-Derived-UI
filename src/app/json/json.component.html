<div>
  <div class="inputbox">
    <br />
    <!--<mat-slide-toggle (click)="toggleView()">JSON</mat-slide-toggle> -->
    <br />
    <mat-tab-group dynamicheight class="vertical-tab-group">
      <mat-tab label="TextBox" class="matTabBody"> <br><div class="textbox">
        <div class="row">
          <div class="col">
            <label for="source">Enter Source:</label>
            <input
              type="text"
              id="source"
              placeholder="Enter Source Name"
              [(ngModel)]="source"
              name="source"
            />
          </div>
          <div class="col">
            <label for="type">Enter Type:</label>
            <input
              type="text"
              id="type"
              placeholder="Enter Type"
              [(ngModel)]="type"
              name="type"
            />
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label for="attributes">Enter Attributes:</label>
            <input
              type="text"
              id="attributes"
              placeholder="Enter Attributes"
              [(ngModel)]="attributes"
              name="attributes"
            />
          </div>
          <div class="col">
            <label for="fields">Enter Derived Property:</label>
            <input
              type="text"
              id="fields"
              placeholder="Enter Derived Property"
              [(ngModel)]="fields"
              name="fields"
            />
          </div>
        </div>
      </div>
      </mat-tab>
      <mat-tab label="JSON" ><br> <div class="textbox">
        <div class="row">
          <div class="col">
            <label for="source">Enter Source:</label>
            <input
              type="text"
              id="source"
              placeholder="Enter Source Name"
              [(ngModel)]="source"
              name="source"
            />
          </div>
          <div class="col">
            <label for="type">Enter Type:</label>
            <input
              type="text"
              id="type"
              placeholder="Enter Type"
              [(ngModel)]="type"
              name="type"
            />
          </div>
        </div>
        <div class="row" >
          <div class="col">
            <label for="input1">(Attributes):</label>
                <input type="file" (change)="onFileSelected($event)" />
          </div>
          <div class="col">
            
            <label for="input2">(Dervied):</label>
                <input type="file" (change)="onFileSelected1($event)" />
          </div>
        </div>
      </div>
      </mat-tab>
      <mat-tab label="CSV/Excel" ><br> <div class="textbox">
        <div class="row">
          <div class="col">
            <label for="source">Enter Source:</label>
            <input
              type="text"
              id="source"
              placeholder="Enter Source Name"
              [(ngModel)]="source"
              name="source"
            />
          </div>
          <div class="col">
            <label for="type">Enter Type:</label>
            <input
              type="text"
              id="type"
              placeholder="Enter Type"
              [(ngModel)]="type"
              name="type"
            />
          </div>
        </div>
        <div class="row">
          <div class="col">
         <label for="input1">(Attributes):</label>
                <input type="file" (change)="onFileSelected2($event)" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
          </div>
          <div class="col">
            <label for="input2">(Dervied):</label>
            <input
            type="text"
            id="fields"
            placeholder="Enter Derived Property"
            [(ngModel)]="fields"
            name="fields"
          />
          </div>
        </div>
      </div>
      </mat-tab>
    </mat-tab-group>
    
   
    <button (click)="onClickTest()" style="width: 100%">Execute</button>
  </div>

  <div style="width: 100%">
    <div style="width: 80%">
      <mat-slide-toggle (click)="toggleSearch()" style="margin-left: auto">
        <input
          *ngIf="searchFieldBool"
          placeholder="Seach for field here"
          class="searchInput"
          #search
          (input)="searchField(search.value, true)"
        />
        <input
          *ngIf="!searchFieldBool"
          placeholder="Seach for attribute here"
          class="searchInput"
          #search
          (input)="searchField(search.value, false)"
        />
      </mat-slide-toggle>
    </div>
    <table>
      <thead>
        <tr>
          <th></th>
          <th>Fields</th>
          <th>Prediction</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let r of searchtransformedJson"
          [ngStyle]="{
            'background-color':
              r.predicted.length == 0 ? 'rgba(233, 84, 84, 0.808)' : ''
          }"
        >
          <td>
            <input
              type="checkbox"
              [checked]="!uncheckedCheckboxes[r.id] && r.predicted.length != 0"
              (change)="toggleCheckbox(r.id)"
            />
          </td>
          <td>
            {{ r.id }}
            <!-- <ng-container *ngIf="!r.editMode">{{ r.id }}</ng-container>
            <input *ngIf="r.editMode" type="text" [(ngModel)]="r.id" /> -->
          </td>
          <td>
            <ng-container *ngIf="!r.editMode">
              <button
                [ngClass]="[
                  'tablebutton',
                  r.id,
                  this.anotherArray[r.id] == field || this.uncheckedCheckboxes[r.id]==field
                    ? 'tablebutton-clicked'
                    : 'tablebutton-notclicked'
                ]"
                *ngFor="let field of r.predicted; let i = index"
                (click)="addToAnotherArray(r.id, field)"
              >
                {{ field }}
              </button>
            </ng-container>
            <input
              *ngIf="r.editMode"
              type="text"
              [(ngModel)]="anotherArray[r.id]"
            />
            <ng-container *ngIf="extractPatterns[r.id]">
              <hr/>Extract : 
              <input class="extractInput" type="text" placeholder="Pattern" [(ngModel)]="extractPatterns[r.id].pattern" [disabled]="!extractPatterns[r.id].editMode"/>
              <input class="extractInput" type="text" placeholder="Extract value" [(ngModel)]="extractPatterns[r.id].extract" [disabled]="!extractPatterns[r.id].editMode"/>
            </ng-container>
          </td>
          <td>
            <button
              title="Click here to edit data"
              style="margin-right: 3px"
              (click)="toggleEditMode(r)"
            >
              <i class="bi bi-check" *ngIf="r.editMode"></i>
              <i class="bi bi-pencil-square" *ngIf="!r.editMode"></i>
            </button>
            <button
              type="button"
              title="Click here to add extract pattern"
              (click)="toggleExtractMode(r)"
            >
              <i class="bi bi-check" *ngIf="extractPatterns[r.id] && extractPatterns[r.id].editMode"></i>
              <i class="bi bi-patch-plus" *ngIf="!(extractPatterns[r.id] && extractPatterns[r.id].editMode)"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- [ngStyle]="{'background-color': isFieldClicked(r.id, field) ? 'rgb(79, 242, 87)' : (isFieldClicked(r.id, r.predicted[0]) ? 'yellow' : (i === 0 ? 'rgb(79, 242, 87)' : 'yellow'))}" (click)="addToAnotherArray(r.id, field)" -->
